<?xml version="1.0" encoding="utf-8" ?>
<universal-editor version="4.0"
				  xmlns="urn:net.alcetech.schemas.UniversalEditor"
				  xmlns:uwt="urn:net.alcetech.schemas.Framework.UserInterface"
				  xmlns:dc="http://purl.org/dc/elements/1.1/">

	<dataFormats>
		<dataFormat id="{09c315b3-ba8d-4e80-953b-32450f524e1f}" typeName="UniversalEditor.Plugins.Abomination.DataFormats.FileSystem.CLTDataFormat">
			<metadata>
				<dc:title>Abomination CLT archive</dc:title>
				<dc:author>Michael Becker</dc:author>
			</metadata>
			<format>
				<!-- drop a reference to the current ObjectModel, optionally casting it to the given dataType -->
				<this id="fsom" dataType="UniversalEditor.ObjectModels.FileSystem.FileSystemObjectModel" />

				<!-- signature field -->
				<field dataType="FixedString" id="Signature" length="2" value="AWAD" />
				<field dataType="UInt32" id="fileCount" />
				<loop from="0" until="$(fileCount)" id="files">
					<field dataType="FixedString" id="fileName" length="260" />
					<field dataType="UInt32" id="length" />
					<field dataType="UInt32" id="offset" />

					<!-- the following two elements create instances of .NET objects which can then be added to the object model -->
					<methodCall objectName="fsom" methodName="AddFile" returnVariableId="file">
						<parameters>
							<param name="name" value="$(fileName)" />
						</parameters>
					</methodCall>
					<instance className="UniversalEditor.ObjectModels.FileSystem.FileSources.EmbeddedFileSource" id="source">
						<constructor>
							<param id="reader" value="$(reader)" />
							<param id="offset" value="$(offset)" />
							<param id="length" value="$(length)" />
						</constructor>
					</instance>
					<setProperty variableId="file" propertyName="Source" value="$(source)" />
					<setProperty variableId="file" propertyName="Length" value="$(length)" />
				</loop>
			</format>
		</dataFormat>
	</dataFormats>
</universal-editor>
